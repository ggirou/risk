<!DOCTYPE html>

<link rel="import" href="player_inline.html">

<polymer-element name="risk-history">
  <template>
    <div id="history" class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">History</h3>
      </div>
      <div class="panel-body pre-scrollable">
        <ul class="list-unstyled">
          <template repeat="{{ event in game.events }}">
            <template if="{{ event | isArmyMoved }}">
              <li>
                <risk-player-inline player="{{ game.players[event.playerId] }}"></risk-player-inline> moved {{ event.armies }} armies from {{ event.from }} to {{ event.to }}.
              </li>
            </template>
            <template if="{{ event | isArmyPlaced }}">
              <li>
                <risk-player-inline player="{{ game.players[event.playerId] }}"></risk-player-inline> put an army on {{ event.country }}.
              </li>
            </template>
            <template if="{{ event | isBattleEnded }}">
              <li>
                <risk-player-inline player="{{ game.players[event.attacker.playerId] }}"></risk-player-inline> attacked from {{ event.attacker.country }} to {{ event.defender.country }} (owned by <risk-player-inline player="{{ game.players[event.defender.playerId] }}"></risk-player-inline>).
                The dices are {{ event.attacker.dices | displayDices }} for attacker vs. {{ event.defender.dices | displayDices }} for defender.
                <template if="{{ event.conquered }}">
                   The country has been conquered.
                </template>
                <template if="{{ !event.conquered }}">
                  {{ event.attacker.remainingArmies }} armies remained for <risk-player-inline player="{{ game.players[event.attacker.playerId] }}"></risk-player-inline>
                  and {{ event.defender.remainingArmies }} armies remained for <risk-player-inline player="{{ game.players[event.defender.playerId] }}"></risk-player-inline>
               </template>
              </li>
            </template>
            <template if="{{ event | isGameStarted }}">
              <li>
                The game started.
              </li>
            </template>
            <template if="{{ event | isNextPlayer }}">
              <li>
                <risk-player-inline player="{{ game.players[event.playerId] }}"></risk-player-inline> played.
              </li>
            </template>
            <template if="{{ event | isNextStep }}">
              <li>
                Next step.
              </li>
            </template>
            <template if="{{ event | isPlayerJoined }}">
              <li>
                <risk-player-inline player="{{ game.players[event.playerId] }}"></risk-player-inline> joined the game.
              </li>
            </template>
            <template if="{{ event | isSetupEnded }}">
              <li>
                Setup ended.
              </li>
            </template>
          </template>
        </ul>
      </div>
    </div>
  </template>
  <script type="application/dart" src="history.dart"></script>
</polymer-element>
