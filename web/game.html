<!DOCTYPE html>

<link rel="import" href="board.html">

<polymer-element name="risk-game">
  <template>
    <link rel="stylesheet" href="css/risk.css">
    <link rel="stylesheet" href="packages/bootstrap_for_pub/3.1.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="packages/bootstrap_for_pub/3.1.0/css/bootstrap-theme.min.css">

    <section class="container-fluid">
      <div class="row">
        <!-- Risk Board -->
        <risk-board id='board' game="{{ game }}" playerId="{{ playerId }}" class="col-md-8"
          on-attack="{{ attack }}"
          on-move="{{ move }}"
          on-selection="{{ selection }}"></risk-board>
        <div class="col-md-4">
          <template if='{{ playerId == game.activePlayerId }}'>
            <div class="panel panel-default">
              <div class="panel-heading">
                <h3 class="panel-title">It's up to you !</h3>
              </div>
              <div class="panel-body" style="text-align: center;">
                <template if='{{ game.turnStep == "REINFORCEMENT" }}'>
                  <h3>Reinforcement</h3>
                  <p>Select one of your country to add one of the <strong>{{ game.players[playerId].reinforcement }}</strong> army left.</p>
                </template>
                <template if='{{ game.turnStep == "ATTACK" }}'>
                  <h3>Attack</h3>
                  <template if='{{ pendingMove == null }}'>
                    <p>Select a country from which you want to engage a battle.</p>
                    <button on-click="{{ endAttack }}">End of attacks</button>
                  </template>
                </template>
                <template if='{{ game.turnStep == "FORTIFICATION" }}'>
                  <h3>Fortification</h3>
                  <template if='{{ pendingMove == null }}'>
                    <p>Select a country from which you want to perform the last move to make ofr this turn.</p>
                    <button on-click="{{ endTurn }}">End of my turn</button>
                  </template>
                </template>
                <template if='{{ pendingMove != null }}'>
                  <div style='text-align: center; padding: 1em;'>
                    <p>How many armies do you want to move from <strong>{{ pendingMove.from }}</strong> to <strong>{{ pendingMove.to }}</strong>?</p>
                    <input type="range" value="{{ armiesToMove | asInteger }}" min="1" max="{{ pendingMove.maxArmies }}" />
                    <button on-click='{{ moveArmies }}'>Move {{ armiesToMove }} armies</button>
                  </div>
                </template>
              </div>
            </div>
          </template>
          <template if='{{ canStart }}'>
            <div style='text-align: center; padding: 1em;'>
              <button on-click='{{ startGame }}'>Start Game</button>
            </div>
          </template>
          <!-- Players List -->
          <ul id="avatars" class="nav nav-pills nav-stacked navbar-inverse img-rounded">
            <template repeat="{{ player in game.players.values }}">
              <li class="{{ {'active': player.playerId == game.activePlayerId} }}">
                <a>
                  <img src="img/avatars/{{ player.avatar }}.png" class="img-rounded" alt="Avatar">
                  <span><b>{{ player.name }}</b></span>
                  <span class="badge pull-right">
                    <i class="riskicon riskicon-soldier"></i>
                    <i class="riskicon riskicon-soldier"></i>
                    0
                  </span>
                </a>
              </li>
            </template>
          </ul>
          <!-- Game history -->
          <div id="history" class="panel panel-default">
            <div class="panel-heading">
              <h3 class="panel-title">History</h3>
            </div>
            <div class="panel-body pre-scrollable">
              <ul class="list-unstyled">
                <li><img src="img/avatars/kadhafi.png" class="img-rounded" alt="Avatar"> John Lennon joined the game</li>
                <li><img src="img/avatars/kadhafi.png" class="img-rounded" alt="Avatar"> John Lennon placed an army on Eastern Australia</li>
                <li><img src="img/avatars/staline.png" class="img-rounded" alt="Avatar"> Ringo Starr attacked <img src="img/avatars/kadhafi.png" class="img-rounded" alt="Avatar"> John Lennon's Eastern Australia with 3 armies from Western Australia</li>
                <li><img src="img/avatars/staline.png" class="img-rounded" alt="Avatar"> Ringo Starr conquered <img src="img/avatars/kadhafi.png" class="img-rounded" alt="Avatar"> John Lennon's Eastern Australia with 3 armies from Western Australia</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </section>
  </template>

  <script type="application/dart" src="game.dart"></script>
</polymer-element>

